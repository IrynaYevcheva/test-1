{"version":3,"file":"commonHelpers.js","sources":["../src/js/message.js","../src/js/simplelightbox.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport default function iziToastMessage(message) {\n  iziToast.show({\n    close: false,\n    closeOnClick: true,\n    message,\n    messageColor: 'white',\n    timeout: 3000,\n    transitionIn: 'flipInX',\n    transitionOut: 'flipOutX',\n    position: 'topRight',\n    backgroundColor: '#EF4040',\n    progressBar: false,\n  });\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox = new SimpleLightbox('#gallery a', {\n  showCounter: false,\n  captionsData: 'alt',\n  captionDelay: 200,\n});\n\nexport default lightbox;\n","import iziToastMessage from './js/message.js';\nimport lightbox from './js/simplelightbox.js';\n\nimport axios from 'axios';\n\nconst form = document.querySelector('#form');\nconst gallery = document.querySelector('#gallery');\nconst loadingMessage = document.querySelector('.loader');\nconst loaderButton = document.querySelector('.loader-button');\n\nconst per_page = 40;\nlet page = 1;\nlet userSearchRequest;\n\nform.addEventListener('submit', onSearch);\nloaderButton.addEventListener('click', onLoadMore);\n\nasync function onSearch(event) {\n  event.preventDefault();\n  loadingMessage.classList.remove('hidden');\n  gallery.innerHTML = '';\n  page = 1;\n  userSearchRequest = event.currentTarget.elements.inputToSearch.value.trim();\n  event.currentTarget.reset();\n  loaderButton.classList.add('hidden');\n  try {\n    const {\n      data: { hits, total, totalHits },\n    } = await getPhoto(userSearchRequest, page);\n    if (!userSearchRequest) {\n      iziToastMessage(`Fill the form`);\n    } else {\n      if (total === 0) {\n        iziToastMessage(\n          `Sorry, there are no images matching your search query. Please try again!`\n        );\n      } else {\n        gallery.innerHTML = renderImages(hits);\n        iziToastMessage(`We found ${total} photos`);\n        hasMorePhotos(totalHits);\n        lightbox.refresh();\n      }\n    }\n  } catch (error) {\n    iziToastMessage(`Api request error: ${error}`);\n  } finally {\n    loadingMessage.classList.add('hidden');\n  }\n}\n\nasync function onLoadMore() {\n  page = +1;\n  loaderButton.classList.add('hidden');\n  loadingMessage.classList.remove('hidden');\n  try {\n    const {\n      data: { hits, total, totalHits },\n    } = await getPhoto(userSearchRequest, page);\n    gallery.insertAdjacentHTML('beforeend', renderImages(hits));\n    hasMorePhotos(totalHits);\n    scroll();\n  } catch (error) {\n    iziToastMessage(`Api request error: ${error}`);\n  } finally {\n    loadingMessage.classList.add('hidden');\n  }\n}\n\nfunction getPhoto(userSearchRequest, page) {\n  const searchParams = new URLSearchParams({\n    key: '41535570-7b1028e1c6f1b041bb0744cc1',\n    q: userSearchRequest,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page,\n    per_page,\n  });\n  return axios.get(`https://pixabay.com/api/?${searchParams}`);\n}\n\nfunction renderImages(arr = []) {\n  return arr\n    .map(\n      img =>\n        `<li class=\"gallery-item\">\n        <a href=\"${img.largeImageURL}\">\n          <img class=\"gallery-img\" src=\"${img.webformatURL}\" alt=\"${img.tags}\" loading=\"lazy\"/>\n        </a>\n        <div class=\"image-info\">\n          <div>Likes:<span>${img.likes}</span></div>\n          <div>Views:<span>${img.views}</span></div>\n          <div>Comments:<span>${img.comments}</span></div>\n          <div>Downloads:<span>${img.downloads}</span></div>\n        </div>\n      </li>`\n    )\n    .join('');\n}\n\nfunction hasMorePhotos(totalHits) {\n  const totalPages = Math.ceil(totalHits / per_page);\n  if (page >= totalPages) {\n    iziToastMessage(\n      'We are sorry, but you have reached the end of search results.'\n    );\n  } else {\n    loaderButton.classList.remove('hidden');\n    if (page >= 2) {\n    }\n  }\n}\n\nfunction scroll() {\n  const scrollItem = document.querySelector('.gallery-item');\n  const galleryItemHeight = scrollItem.getBoundingClientRect().height;\n  window.scrollBy({\n    top: galleryItemHeight * 2.0,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n"],"names":["iziToastMessage","message","iziToast","lightbox","SimpleLightbox","form","gallery","loadingMessage","loaderButton","per_page","page","userSearchRequest","onSearch","onLoadMore","event","hits","total","totalHits","getPhoto","renderImages","hasMorePhotos","error","scroll","searchParams","axios","arr","img","totalPages","galleryItemHeight"],"mappings":"owBAGe,SAASA,EAAgBC,EAAS,CAC/CC,EAAS,KAAK,CACZ,MAAO,GACP,aAAc,GACd,QAAAD,EACA,aAAc,QACd,QAAS,IACT,aAAc,UACd,cAAe,WACf,SAAU,WACV,gBAAiB,UACjB,YAAa,EACjB,CAAG,CACH,CCbA,IAAIE,EAAW,IAAIC,EAAe,aAAc,CAC9C,YAAa,GACb,aAAc,MACd,aAAc,GAChB,CAAC,ECFD,MAAMC,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAiB,SAAS,cAAc,SAAS,EACjDC,EAAe,SAAS,cAAc,gBAAgB,EAEtDC,EAAW,GACjB,IAAIC,EAAO,EACPC,EAEJN,EAAK,iBAAiB,SAAUO,CAAQ,EACxCJ,EAAa,iBAAiB,QAASK,CAAU,EAEjD,eAAeD,EAASE,EAAO,CAC7BA,EAAM,eAAc,EACpBP,EAAe,UAAU,OAAO,QAAQ,EACxCD,EAAQ,UAAY,GACpBI,EAAO,EACPC,EAAoBG,EAAM,cAAc,SAAS,cAAc,MAAM,OACrEA,EAAM,cAAc,QACpBN,EAAa,UAAU,IAAI,QAAQ,EACnC,GAAI,CACF,KAAM,CACJ,KAAM,CAAE,KAAAO,EAAM,MAAAC,EAAO,UAAAC,CAAW,CACjC,EAAG,MAAMC,EAASP,EAAmBD,CAAI,EACrCC,EAGCK,IAAU,EACZhB,EACE,0EACV,GAEQM,EAAQ,UAAYa,EAAaJ,CAAI,EACrCf,EAAgB,YAAYgB,CAAK,SAAS,EAC1CI,EAAcH,CAAS,EACvBd,EAAS,QAAO,GAVlBH,EAAgB,eAAe,CAalC,OAAQqB,EAAO,CACdrB,EAAgB,sBAAsBqB,CAAK,EAAE,CACjD,QAAY,CACRd,EAAe,UAAU,IAAI,QAAQ,CACtC,CACH,CAEA,eAAeM,GAAa,CAC1BH,EAAO,EACPF,EAAa,UAAU,IAAI,QAAQ,EACnCD,EAAe,UAAU,OAAO,QAAQ,EACxC,GAAI,CACF,KAAM,CACJ,KAAM,CAAE,KAAAQ,EAAM,MAAAC,EAAO,UAAAC,CAAW,CACjC,EAAG,MAAMC,EAASP,EAAmBD,CAAI,EAC1CJ,EAAQ,mBAAmB,YAAaa,EAAaJ,CAAI,CAAC,EAC1DK,EAAcH,CAAS,EACvBK,GACD,OAAQD,EAAO,CACdrB,EAAgB,sBAAsBqB,CAAK,EAAE,CACjD,QAAY,CACRd,EAAe,UAAU,IAAI,QAAQ,CACtC,CACH,CAEA,SAASW,EAASP,EAAmBD,EAAM,CACzC,MAAMa,EAAe,IAAI,gBAAgB,CACvC,IAAK,qCACL,EAAGZ,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAD,EACA,SAAAD,CACJ,CAAG,EACD,OAAOe,EAAM,IAAI,4BAA4BD,CAAY,EAAE,CAC7D,CAEA,SAASJ,EAAaM,EAAM,GAAI,CAC9B,OAAOA,EACJ,IACCC,GACE;AAAA,mBACWA,EAAI,aAAa;AAAA,0CACMA,EAAI,YAAY,UAAUA,EAAI,IAAI;AAAA;AAAA;AAAA,6BAG/CA,EAAI,KAAK;AAAA,6BACTA,EAAI,KAAK;AAAA,gCACNA,EAAI,QAAQ;AAAA,iCACXA,EAAI,SAAS;AAAA;AAAA,YAGzC,EACA,KAAK,EAAE,CACZ,CAEA,SAASN,EAAcH,EAAW,CAChC,MAAMU,EAAa,KAAK,KAAKV,EAAYR,CAAQ,EAC7CC,GAAQiB,EACV3B,EACE,+DACN,EAEIQ,EAAa,UAAU,OAAO,QAAQ,CAI1C,CAEA,SAASc,GAAS,CAEhB,MAAMM,EADa,SAAS,cAAc,eAAe,EACpB,sBAAqB,EAAG,OAC7D,OAAO,SAAS,CACd,IAAKA,EAAoB,EACzB,KAAM,EACN,SAAU,QACd,CAAG,CACH"}